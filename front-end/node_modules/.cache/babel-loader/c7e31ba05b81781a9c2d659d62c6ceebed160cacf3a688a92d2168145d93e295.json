{"ast":null,"code":"import React,{useEffect,useMemo,useState}from'react';import{useParams,Link}from'react-router-dom';import Buscar from'../../componentes/interfaz/Buscar';import{obtenerAlumnosPorCurso}from'../../servicios/alumnos';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const norm=s=>(s!==null&&s!==void 0?s:'').toString().normalize('NFD').replace(/[\\u0300-\\u036f]/g,'').toLowerCase().trim();export default function AlumnosDelCurso(){const{id,cursoId}=useParams();// id = nombre del establecimiento (texto)\nconst[alumnos,setAlumnos]=useState([]);const[cursoNombre,setCursoNombre]=useState('');const[q,setQ]=useState('');const[cargando,setCargando]=useState(true);const[error,setError]=useState(null);useEffect(()=>{let vivo=true;setCargando(true);setError(null);obtenerAlumnosPorCurso(cursoId).then(_ref=>{let{curso,alumnos}=_ref;if(!vivo)return;setAlumnos(alumnos);setCursoNombre((curso===null||curso===void 0?void 0:curso.nombre)||(curso===null||curso===void 0?void 0:curso.nombre_display)||'');}).catch(e=>setError((e===null||e===void 0?void 0:e.friendlyMessage)||(e===null||e===void 0?void 0:e.message)||'No se pudo cargar')).finally(()=>{if(vivo)setCargando(false);});return()=>{vivo=false;};},[cursoId]);const filtrados=useMemo(()=>{if(!q)return alumnos;const b=norm(q);return alumnos.filter(a=>[a.run,a.nombreCompleto,a.cursoNombre].filter(Boolean).some(x=>norm(x).includes(b)));},[alumnos,q]);if(cargando){return/*#__PURE__*/_jsx(\"div\",{className:\"text-center my-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border\",role:\"status\"})});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger m-3\",children:error});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container my-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-3\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"mb-0\",children:[\"Alumnos \",cursoNombre?\"- \".concat(cursoNombre):'']}),/*#__PURE__*/_jsx(Link,{to:\"/establecimientos/\".concat(encodeURIComponent(id),\"/estructura\"),className:\"btn btn-secondary btn-sm\",children:\"Volver a cursos\"})]}),/*#__PURE__*/_jsx(Buscar,{placeholder:\"Buscar alumno (RUN o nombre)...\",valor:q,onCambiar:setQ}),/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table table-hover align-middle\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"table-light\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"RUN\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Nombre\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Curso\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:filtrados.length===0?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:3,children:/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-warning m-0\",children:\"Sin resultados.\"})})}):filtrados.map(a=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:a.run||'—'}),/*#__PURE__*/_jsx(\"td\",{children:a.nombreCompleto||'—'}),/*#__PURE__*/_jsx(\"td\",{children:a.cursoNombre||'—'})]},a.id))})]})})]});}","map":{"version":3,"names":["React","useEffect","useMemo","useState","useParams","Link","Buscar","obtenerAlumnosPorCurso","jsx","_jsx","jsxs","_jsxs","norm","s","toString","normalize","replace","toLowerCase","trim","AlumnosDelCurso","id","cursoId","alumnos","setAlumnos","cursoNombre","setCursoNombre","q","setQ","cargando","setCargando","error","setError","vivo","then","_ref","curso","nombre","nombre_display","catch","e","friendlyMessage","message","finally","filtrados","b","filter","a","run","nombreCompleto","Boolean","some","x","includes","className","children","role","concat","to","encodeURIComponent","placeholder","valor","onCambiar","length","colSpan","map"],"sources":["/home/ec2-user/proyecto_integracion/front-end/src/paginas/alumnos/AlumnosDelCurso.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\nimport { useParams, Link } from 'react-router-dom';\nimport Buscar from '../../componentes/interfaz/Buscar';\nimport { obtenerAlumnosPorCurso } from '../../servicios/alumnos';\n\nconst norm = (s) =>\n  (s ?? '').toString().normalize('NFD').replace(/[\\u0300-\\u036f]/g, '').toLowerCase().trim();\n\nexport default function AlumnosDelCurso() {\n  const { id, cursoId } = useParams(); // id = nombre del establecimiento (texto)\n  const [alumnos, setAlumnos] = useState([]);\n  const [cursoNombre, setCursoNombre] = useState('');\n  const [q, setQ] = useState('');\n  const [cargando, setCargando] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    let vivo = true;\n    setCargando(true); setError(null);\n\n    obtenerAlumnosPorCurso(cursoId)\n      .then(({ curso, alumnos }) => {\n        if (!vivo) return;\n        setAlumnos(alumnos);\n        setCursoNombre(curso?.nombre || curso?.nombre_display || '');\n      })\n      .catch((e) => setError(e?.friendlyMessage || e?.message || 'No se pudo cargar'))\n      .finally(() => { if (vivo) setCargando(false); });\n\n    return () => { vivo = false; };\n  }, [cursoId]);\n\n  const filtrados = useMemo(() => {\n    if (!q) return alumnos;\n    const b = norm(q);\n    return alumnos.filter((a) =>\n      [a.run, a.nombreCompleto, a.cursoNombre].filter(Boolean).some((x) => norm(x).includes(b))\n    );\n  }, [alumnos, q]);\n\n  if (cargando) {\n    return <div className=\"text-center my-5\"><div className=\"spinner-border\" role=\"status\" /></div>;\n  }\n  if (error) {\n    return <div className=\"alert alert-danger m-3\">{error}</div>;\n  }\n\n  return (\n    <div className=\"container my-4\">\n      <div className=\"d-flex justify-content-between align-items-center mb-3\">\n        <h5 className=\"mb-0\">Alumnos {cursoNombre ? `- ${cursoNombre}` : ''}</h5>\n        <Link\n          to={`/establecimientos/${encodeURIComponent(id)}/estructura`}\n          className=\"btn btn-secondary btn-sm\"\n        >\n          Volver a cursos\n        </Link>\n      </div>\n\n      <Buscar placeholder=\"Buscar alumno (RUN o nombre)...\" valor={q} onCambiar={setQ} />\n\n      <div className=\"table-responsive\">\n        <table className=\"table table-hover align-middle\">\n          <thead className=\"table-light\">\n            <tr>\n              <th>RUN</th>\n              <th>Nombre</th>\n              <th>Curso</th>\n            </tr>\n          </thead>\n          <tbody>\n            {filtrados.length === 0 ? (\n              <tr>\n                <td colSpan={3}>\n                  <div className=\"alert alert-warning m-0\">Sin resultados.</div>\n                </td>\n              </tr>\n            ) : (\n              filtrados.map((a) => (\n                <tr key={a.id}>\n                  <td>{a.run || '—'}</td>\n                  <td>{a.nombreCompleto || '—'}</td>\n                  <td>{a.cursoNombre || '—'}</td>\n                </tr>\n              ))\n            )}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}